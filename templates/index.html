<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dá»± Ä‘oÃ¡n Náº¥m Äá»™c hay Ä‚n Ä‘Æ°á»£c</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    /* ThÃªm má»™t chÃºt style Ä‘á»ƒ form gá»n hÆ¡n */
    .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    @media (max-width: 600px) { .form-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ„ Dá»± Ä‘oÃ¡n Loáº¡i Náº¥m</h1>
    <p class="subtitle">Nháº­p thÃ´ng sá»‘ Ä‘áº·c Ä‘iá»ƒm Ä‘á»ƒ kiá»ƒm tra náº¥m cÃ³ Ä‘á»™c hay khÃ´ng</p>

    <form id="predict-form">
      <div class="form-grid">
        <div class="form-group">
          <label for="cap-diameter">ÄÆ°á»ng kÃ­nh mÅ© (cm):</label>
          <input type="number" step="0.01" id="cap-diameter" name="cap-diameter" placeholder="VÃ­ dá»¥: 15.2" required>
        </div>

        <div class="form-group">
          <label for="stem-height">Chiá»u cao thÃ¢n (cm):</label>
          <input type="number" step="0.01" id="stem-height" name="stem-height" placeholder="VÃ­ dá»¥: 16.9" required>
        </div>

        <div class="form-group">
          <label for="stem-width">Äá»™ rá»™ng thÃ¢n (mm):</label>
          <input type="number" step="0.01" id="stem-width" name="stem-width" placeholder="VÃ­ dá»¥: 17.1" required>
        </div>

        <div class="form-group">
          <label for="cap-shape">HÃ¬nh dáº¡ng mÅ©:</label>
          <select id="cap-shape" name="cap-shape">
            <option value="x">HÃ¬nh chuÃ´ng (Bell)</option>
            <option value="f">Pháº³ng (Flat)</option>
            <option value="p">HÃ¬nh nÃ³n (Conical)</option>
            <option value="b">Lá»“i (Convex)</option>
            <option value="c">LÃµm (Sunken)</option>
          </select>
        </div>

        <div class="form-group">
          <label for="season">MÃ¹a vá»¥:</label>
          <select id="season" name="season">
            <option value="s">MÃ¹a xuÃ¢n (Spring)</option>
            <option value="u">MÃ¹a hÃ¨ (Summer)</option>
            <option value="a">MÃ¹a thu (Autumn)</option>
            <option value="w">MÃ¹a Ä‘Ã´ng (Winter)</option>
          </select>
        </div>
      </div>

      <button type="submit" class="btn" style="margin-top: 20px;">Kiá»ƒm tra Ä‘á»™ an toÃ n</button>
    </form>

    <div id="result" class="result-card" style="display:none; margin-top: 20px; padding: 20px; border-radius: 8px;">
      <h2>Káº¿t quáº£ phÃ¢n tÃ­ch</h2>
      <p>Loáº¡i náº¥m nÃ y cÃ³ thá»ƒ lÃ : <strong id="prediction-value" style="font-size: 1.5em;">--</strong></p>
    </div>

    <div id="error" class="error-card" style="display:none; color: red;">
      <h2>Lá»—i</h2>
      <p id="error-message"></p>
    </div>
  </div>

  <script>
    const form = document.getElementById('predict-form');
    const resultCard = document.getElementById('result');
    const errorCard = document.getElementById('error');
    const predictionSpan = document.getElementById('prediction-value');
    const errorMessage = document.getElementById('error-message');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      resultCard.style.display = 'none';
      errorCard.style.display = 'none';

      const formData = new FormData(form);

      try {
        const res = await fetch('/predict', {
          method: 'POST',
          body: formData
        });

        const data = await res.json();

        if (data.success) {
          predictionSpan.textContent = data.variety; // Tráº£ vá» 'Ä‚n Ä‘Æ°á»£c' hoáº·c 'CÃ³ Ä‘á»™c'
          
          // Äá»•i mÃ u ná»n káº¿t quáº£ dá»±a trÃªn loáº¡i náº¥m
          if (data.variety.includes("Ä‘á»™c")) {
            resultCard.style.backgroundColor = "#ffcccc";
            predictionSpan.style.color = "#cc0000";
          } else {
            resultCard.style.backgroundColor = "#ccffcc";
            predictionSpan.style.color = "#008000";
          }
          
          resultCard.style.display = 'block';
        } else {
          errorMessage.textContent = data.error || 'CÃ³ lá»—i xáº£y ra.';
          errorCard.style.display = 'block';
        }
      } catch (err) {
        errorMessage.textContent = 'KhÃ´ng thá»ƒ káº¿t ná»‘i Ä‘áº¿n server.';
        errorCard.style.display = 'block';
      }
    });
  </script>
</body>
</html>